/**
* Editor×é¼þ
*/
(function(c){c.uiwidget=c.uiwidget||{};c.uiwidget.isIE=!!window.ActiveXObject;c.uiwidget.isIE6=c.uiwidget.isIE&&!window.XMLHttpRequest;c.uiwidget.isIE8=c.uiwidget.isIE&&!!document.documentMode;c.uiwidget.isIE7=c.uiwidget.isIE&&!c.uiwidget.isIE6&&!c.uiwidget.isIE8;c.uiwidget.Editor=function(a,d){c.extend(this,d);this.target=c(a);this.init();this.render()};c.uiwidget.Editor.prototype={updateBindEl:true,init:function(){this.editing=false},render:function(){this.editElWrap=c('<div class="uiwidget-editor"></div>');
this.target.append(this.editElWrap);this.editEl=c(this.field);this.editElWrap.append(this.editEl);var a=this;this.editEl.blur(function(d){a.handlerOnBlur(d)});this.addEnterEvent(this.editEl)},startEdit:function(a,d,b){this.bindEl=c(a);this.startValue=d||this.bindEl.text();if(this.triggerHandler("beforeStartEdit",[this])!==false){this.editEl.height(b&&b.height?b.height:this.bindEl.innerHeight());navigator.userAgent.toLowerCase();if(c.uiwidget.isIE6)b&&b.width?this.editEl.width(b.width):this.editEl.width(parseFloat(this.bindEl.css("width")));
else b&&b.width?this.editEl.width(b.width):this.editEl.width(this.bindEl.innerWidth());a=this.bindEl.position();this.editElWrap.css("top",b?a.top+b.top:a.top);this.editElWrap.css("left",b?a.left+b.left:a.left);this.editEl.val(this.startValue);this.show();this.editEl.focus();this.editEl.select();this.editing=true;this.triggerHandler("startEdit",[this])}},completeEdit:function(a){if(this.editing){if(this.triggerHandler("beforeComplete",[this],a)===false)return false;this.hide();this.bindEl.show();this.updateBindEl&&
this.bindEl.text(this.editEl.val());this.triggerHandler("onComplete",[this],a);this.editing=false;this.editEl.val("");return true}},cancelEdit:function(){if(this.editing){this.editing=false;this.hide();this.bindEl.show();this.triggerHandler("onCancel",[this]);this.editEl.val("")}},show:function(){this.editElWrap.show()},hide:function(){this.editElWrap.hide()},handlerOnBlur:function(){this.completeEdit();this.completeEdit()||this.cancelEdit()},addEnterEvent:function(a){var d=this;a.keydown(function(b){b.stopPropagation();
if(b.which==13)d.completeEdit(b);else b.which==27&&d.cancelEdit(b)})},getValue:function(){return this.editEl.val()},getStartValue:function(){return this.startValue},getEditEl:function(){return this.editEl},getBindEl:function(){return this.bindEl},bind:function(a,d,b){a=a.toLowerCase();return typeof d=="object"?this.editEl.bind(a,d,b):this.editEl.bind(a,d)},trigger:function(a,d){return this.editEl.trigger(a,d)},triggerHandler:function(a,d,b){a=a.toLowerCase();if(b){if(this.editEl[0]){b.type=a;b.triggerTarget=
b.target;b.stopPropagation();c.event.trigger(b,d,this.editEl[0],false);return b.result}}else return this.editEl.triggerHandler(a,d)}};c.fn.editor=function(a){return new c.uiwidget.Editor(this,a)}})(jQuery);
